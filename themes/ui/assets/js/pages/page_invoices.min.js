$(function () {
    unibox_invoices.init()
});
var $invoice_card = $("#invoice"), $invoice_preview = $("#invoice_preview"), $invoice_form = $("#invoice_form"), $invoices_list_main = $("#invoices_list"), invoice_list_class = ".invoices_list", $invoice_add_btn = $("#invoice_add");
unibox_invoices = {
    init: function () {
        unibox_invoices.copy_list_sidebar(), unibox_invoices.add_new(), unibox_invoices.open_invoice(), unibox_invoices.print_invoice()
    }, add_new: function () {
        if ($invoice_add_btn) {
            var i = function () {
                var i = $("#invoice_form_template"), e = $invoice_card.height(), n = $invoice_card.find(".md-card-content").innerHeight(), t = i.html();
                $(invoice_list_class).find(".md-list-item-active").removeClass("md-list-item-active"), $invoice_card.height(e), $invoice_form.hide().html(t).find(".md-card-content").innerHeight(n);
                var o = function () {
                    var i = $("#invoice_form_template_services"), e = $invoice_form.find("#form_invoice_services"), n = i.html(), t = Handlebars.compile(n), o = e.children().length ? parseInt(e.children(".uk-grid:last").attr("data-service-number")) + 1 : 1, c = {invoice_service_id: o}, a = t(c);
                    e.append(a), unibox_md.inputs(), unibox_forms.textarea_autosize(), unibox_uikit.reinitialize_grid_margin()
                };
                o(), $("#invoice_form_append_service_btn").on("click", function (i) {
                    i.preventDefault(), o()
                }), unibox_md.checkbox_radio()
            }, e = function () {
                $invoice_card.css({height: ""}), $invoice_form.show(), $invoice_preview.html(""), setTimeout(function () {
                    unibox_uikit.reinitialize_grid_margin()
                }, 560)
            };
            $invoice_add_btn.on("click", function (n) {
                n.preventDefault(), unibox_md.card_show_hide($invoice_card, i, e, void 0)
            })
        }
    },
    open_invoice: function () {
        var i = function (i) {
            $invoice_preview.show(), $invoice_form.hide(), $window.resize(), setTimeout(function () {
                unibox_uikit.reinitialize_grid_margin()
            }, 290)
        };
        $(invoice_list_class).on("click", "a", function (e) {
            e.preventDefault(), e.stopPropagation(), unibox_md.card_show_hide($invoice_card, void 0, i, $(this)), $(this).closest("li").siblings("li").removeClass("md-list-item-active").end().addClass("md-list-item-active")
        }),$(invoice_list_class).find("a").length ? $(invoice_list_class).find("a").eq(0).click() : $invoice_add_btn.trigger("click")
    },
    print_invoice: function () {
        $body.on("click", "#invoice_print", function (i) {
            i.preventDefault(), UIkit.modal.confirm("Do you want to print this invoice?", function () {
                unibox_main_sidebar.hide_sidebar(), setTimeout(function () {
                    window.print()
                }, 300)
            }, {labels: {Ok: "print"}})
        })
    }, copy_list_sidebar: function () {
        $sidebar_secondary_toggle.addClass("uk-hidden-large");
        var i = $invoices_list_main.clone();
        i.attr("id", "invoices_list_sidebar"), $sidebar_secondary.find(".sidebar_secondary_wrapper").html(i).end()
    }
};